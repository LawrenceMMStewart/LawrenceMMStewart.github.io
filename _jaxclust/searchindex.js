Search.setIndex({"docnames": ["api", "examples/cnn-mnist", "index"], "filenames": ["api.md", "examples/cnn-mnist.ipynb", "index.rst"], "titles": ["API reference", "Training a CNN on MNIST with the Partial Fenchel-Young Loss", "JAXClust"], "terms": {"jaxclust": 0, "_src": 0, "util": [], "pairwise_square_dist": 1, "x": 1, "arrai": [0, 1], "pair": [], "wise": [], "euclidean": 1, "squar": 1, "distanc": [0, 1], "d_ij": [], "x_i": 1, "x_j": 1, "_2": 1, "2": [1, 2], "input": [], "jax": [0, 1, 2], "output": 1, "d": 0, "In": 1, "thi": [1, 2], "exampl": 1, "we": 1, "simpl": 1, "conv": 1, "net": 1, "us": [0, 1, 2], "flax": 1, "neural": 1, "network": 1, "optax": 1, "optim": 1, "tensorflow": 1, "dataset": 1, "access": 1, "12": 1, "import": 1, "numpi": 1, "np": 1, "jnp": 1, "from": [0, 1, 2], "type": [0, 1], "callabl": [0, 1], "tupl": [0, 1], "ani": 1, "tf": 1, "linen": 1, "nn": 1, "core": 1, "struct": 1, "train_stat": 1, "functool": 1, "tqdm": 1, "matplotlib": 1, "cm": 1, "pyplot": 1, "plt": 1, "random": [0, 1], "seed": 1, "0": [0, 1, 2], "ensur": 1, "doe": 1, "see": 1, "gpu": [1, 2], "grab": 1, "all": [1, 2], "memori": 1, "config": 1, "set_visible_devic": 1, "device_typ": 1, "can": [1, 2], "load": 1, "split": 1, "The": 1, "function": 1, "process_nist_batch": 1, "reshap": 1, "shape": 1, "requir": 1, "lenet5": 1, "well": [0, 1], "renorm": 1, "creat": [0, 1], "one": 1, "hot": 1, "represent": 1, "label": 1, "next_train": 1, "take": [0, 1], "an": [0, 1, 2], "iter": 1, "return": [0, 1], "batch": 1, "y": 1, "new": 1, "reach": 1, "end": 1, "current": 1, "13": 1, "tensorflow_dataset": 1, "tfd": 1, "dshape": 1, "28": 1, "1": [0, 1, 2], "imag": 1, "b": 1, "32": 1, "data_dir": 1, "tmp": 1, "jit": [1, 2], "def": 1, "len": 1, "255": 1, "yhot": 1, "one_hot": 1, "10": 1, "ds_train": 1, "name": 1, "batch_siz": 1, "as_supervis": 1, "true": 1, "from_tensor_slic": 1, "shuffl": 1, "buffer_s": 1, "60000": 1, "reshuffle_each_iter": 1, "train_iter": 1, "as_numpi": 1, "try": 1, "next": 1, "except": 1, "stopiter": 1, "begin": 1, "our": [1, 2], "embed": 1, "14": 1, "class": 1, "modul": 1, "A": [0, 1], "dense1": 1, "int": [0, 1], "256": 1, "size": 1, "dens": 1, "layer": 1, "dense2": 1, "compact": 1, "__call__": 1, "self": 1, "featur": 1, "kernel_s": 1, "3": 1, "relu": 1, "avg_pool": 1, "window_shap": 1, "stride": 1, "64": 1, "flatten": 1, "firstli": 1, "need": 1, "defin": 1, "similar": 1, "measur": 1, "let": [1, 2], "neg": 1, "sigma_": 1, "i": [0, 1, 2], "j": [0, 1], "There": 1, "ar": [0, 1, 2], "mani": 1, "choic": 1, "here": [], "keep": 1, "now": 1, "To": [1, 2], "calcul": [0, 1], "sigma": [0, 1], "write": 1, "15": 1, "pairwis": 1, "between": 1, "point": 1, "n": 1, "g": 1, "dot": 1, "t": 1, "diag": 1, "o": 1, "ones_lik": 1, "given": 1, "matrix": [0, 1], "number": [0, 1], "connect": [0, 1], "compon": [0, 1], "k": [0, 1], "recal": 1, "maximum": [0, 1], "weight": [0, 1], "forest": [0, 1, 2], "problem": 1, "a_k": 1, "text": 1, "argmax": 1, "_": 1, "mathcal": 1, "c": [0, 1], "_k": 1, "langl": 1, "rangl": 1, "where": 1, "adjac": [0, 1], "f_k": 1, "max": 1, "obtain": [0, 1], "solver": [1, 2], "flp": [0, 1], "linear": 1, "program": 1, "get_flp_solv": 1, "constrain": [0, 1], "fals": 1, "use_prim": 1, "sinc": 1, "two": 1, "argument": 1, "ncc": [0, 1], "m": [0, 1], "m_k": 1, "ij": [0, 1], "same": [0, 1], "otherwis": 1, "": [0, 1, 2], "out": 1, "some": 1, "randomli": 1, "gener": 1, "27": [], "randn": 1, "sampl": [0, 1], "3d": 1, "call": 1, "fig": 1, "ax": 1, "subplot": 1, "imshow": 1, "set_titl": 1, "r": 1, "a_": [0, 1], "m_": [0, 1], "5": 1, "39": 1, "coincid": 1, "inform": 1, "constraint": [0, 1], "omega": 1, "about": [], "IT": [], "do": [], "29": [], "csolver": 1, "num_sampl": [0, 1], "100": 1, "order": [0, 1], "both": 1, "proxi": 1, "epsilon": 1, "mathbb": 1, "e": 1, "_z": 1, "left": 1, "z": 1, "right": 1, "perturb": [1, 2], "span": [0, 2], "f_": 1, "f": 1, "make_pert_flp_solv": [0, 1], "found": 1, "similari": [], "pert_solv": 1, "pert_csolv": 1, "whole": 1, "pipelin": 1, "dataclass": 1, "dc": 1, "which": 1, "backbon": 1, "produc": 1, "sai": 1, "previous": 1, "30": [], "supervis": 1, "equival": 1, "arg": [0, 1], "kwarg": [0, 1], "standard": 1, "reduc": 1, "depend": 1, "mean": 1, "std": 1, "forward": 1, "kei": 1, "m_target": 1, "ak": 1, "fk": 1, "mk": 1, "akc": 1, "fkc": 1, "mkc": 1, "partial_fy_loss": 1, "31": [], "dctrainstat": 1, "pytreenod": 1, "step": 1, "apply_fn": 1, "field": 1, "pytree_nod": 1, "forward_fn": 1, "param": 1, "frozendict": 1, "str": 1, "tx": 1, "gradienttransform": 1, "opt_stat": 1, "optstat": 1, "apply_gradi": 1, "grad": 1, "updat": 1, "new_opt_st": 1, "new_param": 1, "apply_upd": 1, "replac": 1, "classmethod": 1, "cl": 1, "init": 1, "method": 1, "adamw": 1, "3e": 1, "4": 1, "weight_decai": 1, "1e": 1, "33": [], "dummy_x": 1, "ones": 1, "prngkei": [0, 1], "34": 1, "clu": 1, "parameter_overview": 1, "print": 1, "get_parameter_overview": 1, "conv_0": 1, "bia": 1, "kernel": 1, "288": 1, "0223": 1, "342": 1, "conv_1": 1, "18": 1, "432": 1, "000226": 1, "0587": 1, "dense_0": 1, "3136": 1, "802": 1, "816": 1, "17e": 1, "05": 1, "0178": 1, "dense_1": 1, "65": 1, "536": 1, "9": 1, "22e": 1, "0625": 1, "total": 1, "887": 1, "680": 1, "35": [], "state": 1, "appli": [0, 1], "make": 1, "perform": 1, "singl": 1, "compat": [1, 2], "36": [], "train_step_fn": 1, "rng": [0, 1], "nois": [0, 1], "value_and_grad": 1, "37": [], "nstep": 1, "300": 1, "rang": 1, "fold_in": 1, "v": 1, "item": 1, "pl": 1, "append": 1, "500": [], "00": 1, "lt": 1, "01": [], "22": 1, "6": 1, "03it": 1, "plot": 1, "throughout": 1, "without": 1, "smooth": 1, "38": [], "moving_averag": 1, "w": 1, "convolv": 1, "valid": 1, "color": 1, "move": 1, "averag": 1, "alpha": 1, "raw": 1, "xlabel": 1, "ylabel": 1, "fy": 1, "tsne": 1, "visual": 1, "ntsne": 1, "3000": 1, "astyp": 1, "40": [], "sklearn": 1, "manifold": 1, "n_compon": 1, "fit_transform": 1, "user": 1, "lawrencestewart": 1, "miniconda3": 1, "env": 1, "m1": 1, "lib": 1, "python3": 1, "site": 1, "packag": 1, "_t_sne": 1, "py": [1, 2], "795": 1, "futurewarn": 1, "default": [0, 1], "initi": 1, "chang": 1, "pca": 1, "warn": 1, "805": 1, "learn": 1, "rate": 1, "200": 1, "auto": 1, "41": [], "tsne_color": 1, "a6cee3": 1, "1f78b4": 1, "b2df8a": 1, "33a02c": 1, "fb9a99": 1, "e31a1c": 1, "fdbf6f": 1, "ff7f00": 1, "cab2d6": 1, "6a3d9a": 1, "color_map": 1, "scatter": 1, "marker": 1, "titl": 1, "xtick": 1, "ytick": 1, "hardwar": 2, "acceler": 2, "batchabl": 2, "differenti": 2, "cluster": [0, 2], "implement": 2, "run": 2, "cpu": [1, 2], "tpu": 2, "algorithm": [0, 2], "instal": 2, "latest": 2, "releas": 2, "follow": [1, 2], "command": 2, "pip": 2, "altern": 2, "sourc": 2, "python": 2, "setup": 2, "subsect": [], "api": 2, "refer": 2, "train": 2, "cnn": 2, "mnist": 2, "partial": 2, "fenchel": 2, "young": 2, "loss": 2, "author": 2, "code": [1, 2], "issu": 2, "tracker": 2, "If": 2, "you": 2, "have": [1, 2], "pleas": 2, "u": [1, 2], "know": 2, "file": [1, 2], "under": 2, "apach": 2, "softwar": 2, "consid": 2, "paper": 1, "http": 1, "arxiv": 2, "org": [], "ab": [], "2305": 2, "16358": 2, "methodologi": 1, "origin": [], "excit": [], "document": [], "list": [], "empti": 1, "surround": [], "line": 1, "nest": [], "sblb23": [], "lawrenc": 2, "stewart": [1, 2], "franci": 2, "bach": 2, "felip": 2, "llinar": 2, "l\u00f3pez": 2, "quentin": 2, "berthet": 2, "2023": [1, 2], "et": [1, 2], "al": [1, 2], "misc": [], "year": [], "eprint": [], "archiveprefix": [], "primaryclass": [], "lg": [], "normal": 0, "distribut": 0, "flp_solver": 0, "bool": 0, "1000": 0, "float": 0, "object": 0, "solv": [], "lp": 0, "indic": 0, "mont": [], "carlo": [], "estim": 0, "expect": [], "amplitud": [], "structur": [], "custom": [], "jvp": [], "forward_pert": [], "ckruskal": 0, "kruskal": 0, "fulli": [], "graph": [], "respect": [], "must": [0, 1], "link": [0, 1], "note": 1, "longer": [], "matroid": [], "like": [], "henc": 0, "onli": [], "heurist": 0, "edg": 0, "first": [], "befor": [], "ad": [], "check": [], "violat": [], "below": [], "more": [], "info": [], "a_ij": [], "m_ij": [], "c_ij": [], "ha": 0, "ckruskals_prims_post": 0, "afterward": 0, "prim": 0, "ran": [], "each": 0, "guarente": 0, "better": 0, "worst": [], "equal": [], "solut": 0, "tree": 0, "construct": 0, "minimum": 0, "kruskals_prims_pr": 0, "full": 0, "extract": [], "cacul": [], "second": [], "pass": 1, "paramet": [0, 1], "version": [], "option": 0, "mc": 0, "_type_": 0, "bias": 0, "base": 0, "c_": [0, 1], "ml": 0, "mnl": 0, "recalcul": 0, "least": 0, "good": 0, "than": 0, "pre": [], "post": [], "process": 1, "matric": 1, "variabl": [], "set": 1, "magnitud": 0, "rtype": [], "could": 1, "correspond": 1, "maxmium": 1, "valu": 1, "For": 1, "clariti": 1, "form": 1, "impli": 1, "non": 1, "denot": 1, "onc": 1, "again": 1, "time": 1, "unconstrain": 1, "gradient": 1, "ell": 1, "whose": 1, "nabla_": 1, "encapsul": 1, "evalu": 1, "instanti": 1, "abov": 1, "loop": 1, "just": 1, "few": 1, "come": 1, "advanc": 1, "system": 1, "sy": 1, "path": 1, "16": 1, "45": 1, "17": 1, "766694": 1, "platform": 1, "cloud": 1, "google_auth_provid": 1, "cc": 1, "184": 1, "attempt": 1, "get": 1, "googl": 1, "authent": 1, "bearer": 1, "token": 1, "fail": 1, "retriev": 1, "not_found": 1, "locat": 1, "credenti": 1, "gce": 1, "failed_precondit": 1, "error": 1, "execut": 1, "request": 1, "libcurl": 1, "couldn": 1, "resolv": 1, "host": 1, "detail": 1, "metadata": 1, "download": 1, "prepar": 1, "11": 1, "06": 1, "mib": 1, "21": 1, "subsequ": 1, "reus": 1, "276731": 1, "profile_util": 1, "cpu_util": 1, "128": 1, "frequenc": 1, "hz": 1, "7": 1, "8": 1, "49": 1, "19": 1, "20": 1}, "objects": {"jaxclust._src": [[0, 0, 0, "-", "perturbations"], [0, 0, 0, "-", "solvers"]], "jaxclust._src.perturbations": [[0, 1, 1, "", "make_pert_flp_solver"]], "jaxclust._src.solvers": [[0, 1, 1, "", "ckruskals"], [0, 1, 1, "", "ckruskals_prims_post"], [0, 1, 1, "", "kruskals"], [0, 1, 1, "", "kruskals_prims_pre"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "refer": 0, "exampl": 2, "train": 1, "cnn": 1, "mnist": 1, "partial": 1, "fenchel": 1, "young": 1, "loss": 1, "data": 1, "loader": 1, "model": 1, "implement": 1, "differenti": 1, "cluster": 1, "jaxclust": [1, 2], "document": 2, "about": 2, "support": 2, "licens": 2, "cite": 2, "some": [], "featur": [], "subsect": [], "perturb": 0, "solver": 0}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinxcontrib.bibtex": 9, "sphinx": 60}, "alltitles": {"API reference": [[0, "api-reference"]], "Solvers": [[0, "module-jaxclust._src.solvers"]], "Perturbations": [[0, "module-jaxclust._src.perturbations"]], "Training a CNN on MNIST with the Partial Fenchel-Young Loss": [[1, "Training-a-CNN-on-MNIST-with-the-Partial-Fenchel-Young-Loss"]], "Data loader and Model": [[1, "Data-loader-and-Model"]], "Implementing Differentiable Clustering with JAXClust": [[1, "Implementing-Differentiable-Clustering-with-JAXClust"]], "JAXClust": [[2, "jaxclust"]], "Documentation:": [[2, null]], "Examples": [[2, null]], "About": [[2, null]], "Support": [[2, "support"]], "License": [[2, "license"]], "Citing": [[2, "citing"]]}, "indexentries": {"ckruskals() (in module jaxclust._src.solvers)": [[0, "jaxclust._src.solvers.ckruskals"]], "ckruskals_prims_post() (in module jaxclust._src.solvers)": [[0, "jaxclust._src.solvers.ckruskals_prims_post"]], "jaxclust._src.perturbations": [[0, "module-jaxclust._src.perturbations"]], "jaxclust._src.solvers": [[0, "module-jaxclust._src.solvers"]], "kruskals() (in module jaxclust._src.solvers)": [[0, "jaxclust._src.solvers.kruskals"]], "kruskals_prims_pre() (in module jaxclust._src.solvers)": [[0, "jaxclust._src.solvers.kruskals_prims_pre"]], "make_pert_flp_solver() (in module jaxclust._src.perturbations)": [[0, "jaxclust._src.perturbations.make_pert_flp_solver"]], "module": [[0, "module-jaxclust._src.perturbations"], [0, "module-jaxclust._src.solvers"]]}})